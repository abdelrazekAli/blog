(this["webpackJsonphello-react"]=this["webpackJsonphello-react"]||[]).push([[0],{119:function(e,t,a){"use strict";a.r(t);var s=a(1),r=a.n(s),c=a(25),n=a.n(c),i=(a(88),a(124)),o=a(15),l=a(13),d=a(10),u=a(121),j=a(0),b=function(e){var t=e.title;return Object(j.jsx)("div",{className:"head d-flex justify-content-center align-items-center",children:Object(j.jsx)(u.a,{className:"d-flex justify-content-center",children:Object(j.jsx)("h1",{className:"text-white display-2 mx-3",children:t||"Welcome to Our Blog"})})})},m=a(45),h=function(){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(b,{title:"Contact Me"}),Object(j.jsx)("div",{class:"features text-center",children:Object(j.jsx)("div",{class:"container",children:Object(j.jsxs)("div",{class:"row",children:[Object(j.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#2867B2"},class:"col hover-opacity",href:"https://www.linkedin.com/in/abdelrazek-ali/",children:[Object(j.jsx)(m.c,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(j.jsx)("h4",{className:"mb-5",children:"LinkedIn"})]}),Object(j.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#161b22"},class:"col hover-opacity",href:"https://github.com/abdelrazekAli",children:[Object(j.jsx)(m.b,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(j.jsx)("h4",{children:"Github"})]}),Object(j.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#ec4636"},class:"col hover-opacity",href:"mailto:dev.abdelrazek@gmail.com?subject=contact",children:[Object(j.jsx)(m.d,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(j.jsx)("h4",{children:"Gmail"})]}),Object(j.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#4267B2"},class:"col hover-opacity",href:"https://www.facebook.com/dev.abdelrazek/",children:[Object(j.jsx)(m.a,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(j.jsx)("h4",{children:"Facebook"})]}),Object(j.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#25D366"},class:"col hover-opacity",href:"https://api.whatsapp.com/send?phone=+201155596710",children:[Object(j.jsx)(m.e,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(j.jsx)("h4",{children:"Whatsapp"})]})]})})})]})},p=a(7),O=a.n(p),x=a(9),g=a(2),f=a(6),v=a(14),y=a.n(v),w=a(122),k=a(79),N=a(128),S=a(123),V=function(){var e=Object(s.useContext)(o.a),t=e.dispatch,a=e.isFetching,r=e.error,c=Object(s.useState)({touched:!1,isValid:!1,msg:""}),n=Object(f.a)(c,2),i=n[0],l=n[1],d=Object(s.useState)({touched:!1,isValid:!1,msg:""}),b=Object(f.a)(d,2),m=b[0],h=b[1],p=function(){var e=Object(x.a)(O.a.mark((function e(a){var s,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),t({type:"LOGIN_START"}),s=a.target.email.value,r=a.target.password.value,e.prev=3,!i.isValid||!m.isValid){e.next=10;break}return e.next=7,y.a.post("/api/v1/users/login",{email:s,password:r});case 7:c=e.sent,t({type:"LOGIN_SUCCESS",payload:c.data}),window.location.replace("/app");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),t({type:"LOGIN_FAILURE"}),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(u.a,{children:Object(j.jsx)(w.a,{children:Object(j.jsxs)(k.a,{md:6,lg:4,className:" mx-auto bg-light p-4 my-4 shadow-sm",children:[Object(j.jsx)("h2",{className:" text-center h4 m-3 text-secondary",children:"Login"}),Object(j.jsxs)(N.a,{onSubmit:p,children:[Object(j.jsxs)(N.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(j.jsx)(N.a.Label,{children:"Email address"}),Object(j.jsx)(N.a.Control,{type:"email",placeholder:"Enter email",name:"email",onBlur:function(e){var t=e.target.value.trim(),a=Object(g.a)({},i);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Email is required."):/\S+@\S+\.\S+/.test(t)?t.length>100?(a.isValid=!1,a.msg="Email must be less than 100 characters."):(a.isValid=!0,a.msg=""):(a.isValid=!1,a.msg="Email is not valid"),l(Object(g.a)({},a))},className:function(){if(i.touched)return i.isValid?"border border-success":"border border-danger"}()}),i.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:i.msg})]}),Object(j.jsxs)(N.a.Group,{className:"mb-3",controlId:"formPlaintextPassword",children:[Object(j.jsx)(N.a.Label,{children:"Password"}),Object(j.jsx)(N.a.Control,{type:"password",placeholder:"Enter password",name:"password",onKeyUp:function(e){var t=e.target.value.trim(),a=Object(g.a)({},m);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Password is required."):t.length<4?(a.isValid=!1,a.msg="Password must be more than 3 characters."):t.length>255?(a.isValid=!1,a.msg="Password must be less than 255 characters."):(a.isValid=!0,a.msg=""),h(Object(g.a)({},a))},className:function(){if(m.touched)return m.isValid?"border border-success":"border border-danger"}()}),m.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:m.msg})]}),Object(j.jsx)(S.a,{variant:"primary",type:"submit",className:"w-100",disabled:!i.isValid||!m.isValid,children:a?"Loading ...":"Login"}),r&&Object(j.jsx)("div",{className:"alert alert-danger text-center my-2",children:"Invalid email or password"})]})]})})})},E=a(130),C=a(132),I=a.p+"static/media/defaultImg.11e9da86.jpg",T=function(e){var t=e.post,a=e.onShow,r=e.userProfile,c=e.onDelete,n=Object(s.useContext)(o.a).user;return Object(j.jsxs)(E.a,{className:"mb-4 mx-4 mx-lg-0",children:[Object(j.jsx)(l.b,{to:"/posts/".concat(t._id),children:Object(j.jsx)(E.a.Img,{variant:"top",src:t.postImg?"https://azstorageabdelrazek.blob.core.windows.net/postimgs/".concat(t.postImg):I})}),Object(j.jsxs)(E.a.Body,{children:[Object(j.jsxs)("div",{className:"px-1 text-center",children:[Object(j.jsx)(E.a.Title,{children:t.title}),Object(j.jsx)(E.a.Text,{children:function(){if(t.body.length<150)return t.body;var e=t.body.substr(0,150);return e=e.substr(0,Math.min(e.length,e.lastIndexOf(" "))),"".concat(e," . . .")}()})]}),Object(j.jsxs)(C.a,{variant:"flush",children:[Object(j.jsx)(C.a.Item,{children:n&&n._id===t.createdBy._id?Object(j.jsx)(l.b,{className:"username-link",to:"/edit-profile",children:t.createdBy?t.createdBy.username:"user"}):Object(j.jsx)(l.b,{className:"username-link",to:{pathname:"/profile/".concat(t.createdBy._id),state:{username:t.createdBy.username}},children:t.createdBy?t.createdBy.username:"user"})}),Object(j.jsx)(C.a.Item,{children:new Date(t.createdAt).toDateString()}),Object(j.jsxs)(C.a.Item,{children:[Object(j.jsx)(l.b,{className:"btn btn-primary",style:{marginRight:"5px"},to:"/posts/".concat(t._id),children:"Open Post"}),!r&&Object(j.jsx)(S.a,{variant:"primary",onClick:function(){return a(t)},children:"Open Modal"}),r&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(l.b,{className:"btn btn-primary",to:{pathname:"/edit-post/".concat(t._id),state:{postTitle:t.title,postBody:t.body,postImg:t.postImg}},style:{marginRight:"5px"},children:"Edit Post"}),Object(j.jsx)(S.a,{variant:"danger",onClick:function(){return c(t)},children:"Delete Post"})]})]})]})]})]})},P=function(){var e=Object(s.useState)([]),t=Object(f.a)(e,2),a=t[0],r=t[1],c=Object(d.g)(),n=Object(d.h)().id,o=c.state.username;Object(s.useEffect)((function(){(function(){var e=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("/api/v1/posts?userId=".concat(n));case 3:t=e.sent,r(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[n]);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(b,{title:"".concat(o)}),Object(j.jsxs)(u.a,{children:[Object(j.jsxs)("h2",{id:"posts",className:"h3 border-bottom mb-4 pb-4 text-primary",children:[o," posts"]}),Object(j.jsx)(w.a,{className:"justify-content-center g-4",children:a.length>0?a.map((function(e){return Object(j.jsx)(k.a,{md:6,lg:4,children:Object(j.jsx)(T,{post:e})},e._id)})):Object(j.jsx)(i.a,{animation:"border",role:"status"})})]})]})},B=function(){var e=Object(s.useState)({touched:!1,isValid:!1,msg:""}),t=Object(f.a)(e,2),a=t[0],r=t[1],c=Object(s.useState)({touched:!1,isValid:!1,msg:""}),n=Object(f.a)(c,2),i=n[0],o=n[1],l=Object(s.useState)({touched:!1,isValid:!1,msg:""}),d=Object(f.a)(l,2),b=d[0],m=d[1],h=Object(s.useState)({isError:!1,msg:""}),p=Object(f.a)(h,2),v=p[0],V=p[1],E=Object(s.useState)(!1),C=Object(f.a)(E,2),I=C[0],T=C[1],P=function(){var e=Object(x.a)(O.a.mark((function e(t){var s,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),T(!0),V({isError:!1,msg:""}),s=t.target.username.value,r=t.target.email.value,c=t.target.password.value,e.prev=4,!(a.isValid&&i.isValid&&b.isValid)){e.next=10;break}return e.next=8,y.a.post("/api/v1/users",{username:s,email:r,password:c});case 8:e.sent.data&&(window.location.replace("/app/login"),T(!1));case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),T(!1),409===e.t0.response.status?V({isError:!0,msg:"Email is already used"}):V({isError:!0,msg:"Somthing went wrong!"});case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(u.a,{children:Object(j.jsx)(w.a,{children:Object(j.jsxs)(k.a,{md:6,lg:4,className:" mx-auto bg-light p-4 my-4 shadow-sm",children:[Object(j.jsx)("h2",{className:" text-center h4 m-3 text-secondary",children:"Register"}),Object(j.jsxs)(N.a,{onSubmit:P,children:[Object(j.jsxs)(N.a.Group,{className:"mb-3",children:[Object(j.jsx)(N.a.Label,{children:"Username"}),Object(j.jsx)(N.a.Control,{type:"text",placeholder:"Enter username",name:"username",onBlur:function(e){var t=e.target.value.trim(),s=Object(g.a)({},a);s.touched=!0,t.length<=0?(s.isValid=!1,s.msg="Username is required."):t.length<4?(s.isValid=!1,s.msg="Username must be more than 3 characters."):t.length>100?(s.isValid=!1,s.msg="Username must be less than 100 characters."):(s.isValid=!0,s.msg=""),r(Object(g.a)({},s))},className:function(){if(a.touched)return a.isValid?"border border-success":"border border-danger"}()}),a.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:a.msg})]}),Object(j.jsxs)(N.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(j.jsx)(N.a.Label,{children:"Email address"}),Object(j.jsx)(N.a.Control,{type:"email",placeholder:"Enter email",name:"email",onBlur:function(e){var t=e.target.value.trim(),a=Object(g.a)({},i);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Email is required."):/\S+@\S+\.\S+/.test(t)?t.length>100?(a.isValid=!1,a.msg="Email must be less than 100 characters."):(a.isValid=!0,a.msg=""):(a.isValid=!1,a.msg="Email is not valid"),o(Object(g.a)({},a))},className:function(){if(i.touched)return i.isValid?"border border-success":"border border-danger"}()}),i.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:i.msg})]}),Object(j.jsxs)(N.a.Group,{className:"mb-3",controlId:"formPlaintextPassword1",children:[Object(j.jsx)(N.a.Label,{children:"Password"}),Object(j.jsx)(N.a.Control,{type:"password",placeholder:"Enter password",name:"password",onKeyUp:function(e){var t=e.target.value.trim(),a=Object(g.a)({},b);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Password is required."):t.length<4?(a.isValid=!1,a.msg="Password must be more than 3 characters."):t.length>255?(a.isValid=!1,a.msg="Password must be less than 255 characters."):(a.isValid=!0,a.msg=""),m(Object(g.a)({},a))},className:function(){if(b.touched)return b.isValid?"border border-success":"border border-danger"}()}),b.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:b.msg})]}),Object(j.jsx)(S.a,{variant:"primary",type:"submit",className:"w-100",disabled:!a.isValid||!i.isValid||!b.isValid,children:I?"Loading ...":"Register"}),v.isError&&Object(j.jsx)("div",{className:"alert alert-danger text-center my-2",children:v.msg})]})]})})})},_=a(38),L=a(125),U=function(){var e=Object(s.useContext)(o.a),t=e.user,a=e.dispatch,r=Object(s.useState)(t.username),c=Object(f.a)(r,2),n=c[0],i=c[1],d=Object(s.useState)(t.email),b=Object(f.a)(d,2),m=b[0],h=b[1],p=Object(s.useState)({touched:!1,isValid:!0,msg:""}),v=Object(f.a)(p,2),V=v[0],E=v[1],C=Object(s.useState)({touched:!1,isValid:!0,msg:""}),I=Object(f.a)(C,2),P=I[0],B=I[1],U=Object(s.useState)([]),F=Object(f.a)(U,2),G=F[0],D=F[1],z=Object(s.useState)(!1),q=Object(f.a)(z,2),R=q[0],A=q[1],M=Object(s.useState)(!1),H=Object(f.a)(M,2),J=H[0],W=H[1],K=Object(s.useState)(!1),Y=Object(f.a)(K,2),Q=Y[0],X=Y[1],Z=Object(s.useState)(!1),$=Object(f.a)(Z,2),ee=$[0],te=$[1],ae=Object(s.useState)({isError:!1,isSuccess:!1}),se=Object(f.a)(ae,2),re=se[0],ce=se[1],ne=Object(s.useState)({isError:!1,msg:""}),ie=Object(f.a)(ne,2),oe=ie[0],le=ie[1];Object(s.useEffect)((function(){(function(){var e=Object(x.a)(O.a.mark((function e(){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("/api/v1/posts?userId=".concat(t._id));case 3:a=e.sent,D(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[Q,t._id]);var de=function(){var e=Object(x.a)(O.a.mark((function e(){var s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.post("/api/v1/users/refresh-token",{token:t.refreshToken});case 3:return s=e.sent,a({type:"LOGIN_SUCCESS",payload:Object(g.a)(Object(g.a)({},t),{},{accessToken:s.data.accessToken})}),e.abrupt("return",s.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),ue=y.a.create(),je=Object(_.a)(t.accessToken);ue.interceptors.request.use(function(){var e=Object(x.a)(O.a.mark((function e(t){var a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Date,!(1e3*je.exp<a.getTime())){e.next=6;break}return e.next=4,de();case 4:s=e.sent,t.headers["auth-token"]=s.accessToken;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)}));var be=function(){var e=Object(x.a)(O.a.mark((function e(a){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ue.delete("/api/v1/posts/".concat(a._id),{headers:{"auth-token":t.accessToken}});case 3:e.sent&&(X(!Q),ce({isError:!1,isSuccess:!0})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),ce({isError:!0,isSuccess:!1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(x.a)(O.a.mark((function e(s){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),e.prev=1,A(!0),le({isError:!1,msg:""}),!V.isValid||!P.isValid){e.next=9;break}return e.next=7,ue.put("/api/v1/users/".concat(t._id),{username:n,email:m},{headers:{"auth-token":t.accessToken}});case 7:(r=e.sent)&&(a({type:"LOGIN_SUCCESS",payload:Object(g.a)(Object(g.a)({},t),{},{username:r.data.username,email:r.data.email})}),A(!1),te(!0));case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),te(!1),A(!1),409===e.t0.response.status?le({isError:!0,msg:"Email is already used"}):le({isError:!0,msg:"Somthing went wrong!"});case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)(u.a,{children:[re.isError&&Object(j.jsx)(L.a,{variant:"danger",onClose:function(){return ce({isError:!1,isSuccess:!1})},className:"success-alert",dismissible:!0,children:Object(j.jsx)(L.a.Heading,{className:"f-1",children:"Somthing went wrong!"})}),re.isSuccess&&Object(j.jsx)(L.a,{variant:"success",onClose:function(){return ce({isError:!1,isSuccess:!1})},className:"success-alert",dismissible:!0,children:Object(j.jsx)(L.a.Heading,{className:"f-1",children:"Post has been successfully deleted"})}),Object(j.jsx)(w.a,{children:Object(j.jsxs)(k.a,{md:6,lg:4,className:" mx-auto bg-light p-4 my-4 shadow-sm",children:[!J&&Object(j.jsx)("div",{style:{textAlign:"center"},children:Object(j.jsx)(S.a,{variant:"primary",className:"w-50",onClick:function(){return W(!0)},children:"Update Profile"})}),J&&Object(j.jsxs)(N.a,{onSubmit:me,children:[Object(j.jsxs)(N.a.Group,{className:"mb-3",children:[Object(j.jsx)(N.a.Label,{children:"Username"}),Object(j.jsx)(N.a.Control,{type:"text",placeholder:"Enter username",name:"username",value:n,onChange:function(e){var t=e.target.value;i(t);var a=Object(g.a)({},V);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Username is required."):t.length<4?(a.isValid=!1,a.msg="Username must be more than 3 characters."):t.length>100?(a.isValid=!1,a.msg="Username must be less than 100 characters."):(a.isValid=!0,a.msg=""),E(Object(g.a)({},a))},className:function(){if(V.touched)return V.isValid?"border border-success":"border border-danger"}()}),V.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:V.msg})]}),Object(j.jsxs)(N.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(j.jsx)(N.a.Label,{children:"Email address"}),Object(j.jsx)(N.a.Control,{type:"email",placeholder:"Enter email",name:"email",value:m,onChange:function(e){var t=e.target.value;h(t);var a=Object(g.a)({},P);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Email is required."):!function(e){return/\S+@\S+\.\S+/.test(e)}(t)?(a.isValid=!1,a.msg="Email is not valid"):t.length>100?(a.isValid=!1,a.msg="Email must be less than 100 characters."):(a.isValid=!0,a.msg=""),B(Object(g.a)({},a))},className:function(){if(P.touched)return P.isValid?"border border-success":"border border-danger"}()}),P.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:P.msg})]}),Object(j.jsx)(S.a,{variant:"primary",type:"submit",className:"w-100",disabled:!V.isValid||!P.isValid,children:R?"Loading ...":"Update"}),ee&&Object(j.jsx)("div",{className:"alert alert-success text-center my-2",children:"Update Successfully"}),oe.isError&&Object(j.jsx)("div",{className:"alert alert-danger text-center my-2",children:oe.msg})]})]})}),Object(j.jsx)("h2",{id:"posts",className:"h3 border-bottom mb-4 pb-4 text-primary",children:"Your Posts"}),Object(j.jsx)(w.a,{className:"justify-content-center g-4",children:G.length>0?G.map((function(e){return Object(j.jsx)(k.a,{md:6,lg:4,children:Object(j.jsx)(T,{post:e,userProfile:!0,onDelete:be})},e._id)})):Object(j.jsxs)("h5",{className:"my-4",children:["You do not have any posts, ",Object(j.jsx)(l.b,{to:"/posts/add-post",children:"Write now"})]})})]})},F=a(127),G=function(e){var t=e.showModal,a=e.hideModal,s=e.modalData;return Object(j.jsxs)(F.a,{show:t,size:"lg",centered:!0,onHide:a,children:[Object(j.jsx)(F.a.Header,{closeButton:!0,children:Object(j.jsx)(F.a.Title,{id:"contained-modal-title-vcenter",children:s.title})}),Object(j.jsx)(F.a.Body,{children:Object(j.jsx)("p",{children:s.body})}),Object(j.jsx)(F.a.Footer,{children:Object(j.jsx)(S.a,{onClick:a,children:"Close"})})]})},D=function(){var e=Object(s.useState)([]),t=Object(f.a)(e,2),a=t[0],r=t[1],c=Object(s.useState)({}),n=Object(f.a)(c,2),o=n[0],l=n[1],d=Object(s.useState)(!1),b=Object(f.a)(d,2),m=b[0],h=b[1];Object(s.useEffect)((function(){(function(){var e=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("/api/v1/posts");case 3:(t=e.sent)&&r(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]);return Object(j.jsxs)(u.a,{children:[Object(j.jsx)("h2",{id:"posts",className:"h3 border-bottom mb-4 pb-4 text-primary",children:"Posts"}),Object(j.jsx)(G,{showModal:m,hideModal:function(){h(!1)},modalData:o}),Object(j.jsx)(w.a,{className:"justify-content-center g-4",children:a.length>0?a.map((function(e){return Object(j.jsx)(k.a,{md:6,lg:4,children:Object(j.jsx)(T,{post:e,onShow:function(){return function(e){h(!0),l(e)}(e)}})},e._id)})):Object(j.jsx)(i.a,{className:"my-4",animation:"border",role:"status"})})]})},z=function(){var e=Object(s.useContext)(o.a).user;return Object(j.jsxs)("div",{children:[Object(j.jsx)(b,{title:e&&"Welcome ".concat(e.username,", to our blog")}),Object(j.jsx)(D,{})]})},q=a(41),R=a(42),A=a(61),M=a(59),H=function(e){Object(A.a)(a,e);var t=Object(M.a)(a);function a(){return Object(q.a)(this,a),t.apply(this,arguments)}return Object(R.a)(a,[{key:"componentDidMount",value:function(){this.props.history.replace("/not-found")}},{key:"render",value:function(){return Object(j.jsx)("div",{children:Object(j.jsx)(b,{title:"404 not found"})})}}]),a}(r.a.Component),J=a(129),W=a(131),K=function(){var e=Object(s.useContext)(o.a),t=e.user,a=e.dispatch,r=function(){var e=Object(x.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.post("/api/v1/users/logout",{token:t.refreshToken});case 3:e.sent&&(a({type:"LOGOUT"}),window.location.replace("/app")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),window.location.replace("/app");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(j.jsx)(J.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",sticky:"top",children:Object(j.jsxs)(u.a,{children:[Object(j.jsx)(J.a.Brand,{children:Object(j.jsx)(l.b,{className:"white-link",to:"/",children:"Mern Blog"})}),Object(j.jsx)(J.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(j.jsx)(J.a.Collapse,{id:"responsive-navbar-nav",className:"justify-content-end",children:Object(j.jsxs)(W.a,{className:"",children:[Object(j.jsx)(l.c,{className:"nav-link",exact:!0,to:"/",children:"home"}),t?null:Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(l.c,{className:"nav-link",to:"/login",children:"login"}),Object(j.jsx)(l.c,{className:"nav-link",to:"/register",children:"register"})]}),t?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(l.c,{className:"nav-link",to:"/add-post",children:"write"}),Object(j.jsx)(l.c,{className:"nav-link",to:"/edit-profile",children:"profile"}),Object(j.jsx)("span",{className:"nav-link",style:{cursor:"pointer"},onClick:r,children:"logout"})]}):null,Object(j.jsx)(l.c,{className:"nav-link",to:"/about",children:"contact"})]})})]})})},Y=function(){return Object(j.jsx)("footer",{className:"d-flex justify-content-center p-4 bg-light",children:Object(j.jsx)("h4",{className:"lead text-secondary",children:" \xa9 2021 Abdelrazek"})})},Q=a(126),X=function(){var e=Object(s.useContext)(o.a),t=e.user,a=e.dispatch,r=Object(d.h)().id,c=Object(d.g)().state,n=c.postTitle,i=c.postBody,l=c.postImg,b=Object(s.useState)(n),m=Object(f.a)(b,2),h=m[0],p=m[1],v=Object(s.useState)(i),V=Object(f.a)(v,2),E=V[0],C=V[1],I=Object(s.useState)(null),T=Object(f.a)(I,2),P=T[0],B=T[1],L=Object(s.useState)(!1),U=Object(f.a)(L,2),F=U[0],G=U[1],D=Object(s.useState)(!1),z=Object(f.a)(D,2),q=z[0],R=z[1],A=Object(s.useState)({touched:!1,isValid:!0,msg:""}),M=Object(f.a)(A,2),H=M[0],J=M[1],W=Object(s.useState)({touched:!1,isValid:!0,msg:""}),K=Object(f.a)(W,2),Y=K[0],X=K[1],Z=Object(s.useState)({isError:!1,msg:""}),$=Object(f.a)(Z,2),ee=$[0],te=$[1],ae=function(){var e=Object(x.a)(O.a.mark((function e(){var s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.post("/api/v1/users/refresh-token",{token:t.refreshToken});case 3:return s=e.sent,a({type:"LOGIN_SUCCESS",payload:Object(g.a)(Object(g.a)({},t),{},{accessToken:s.data.accessToken})}),e.abrupt("return",s.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),se=y.a.create();se.interceptors.request.use(function(){var e=Object(x.a)(O.a.mark((function e(a){var s,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=new Date,!(1e3*Object(_.a)(t.accessToken).exp<s.getTime())){e.next=7;break}return e.next=5,ae();case 5:r=e.sent,a.headers["auth-token"]=r.accessToken;case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)}));var re=function(){var e=Object(x.a)(O.a.mark((function e(a){var s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),e.prev=1,!H.isValid||!Y.isValid){e.next=12;break}return(s=new FormData).append("title",h),s.append("body",E),P&&s.append("image",P),G(!0),e.next=10,se({method:"put",url:"/api/v1/posts/".concat(r),data:s,headers:{"auth-token":t.accessToken,"Content-Type":"multipart/form-data"}});case 10:e.sent.data&&(G(!1),R(!0));case 12:e.next=20;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0),G(!1),R(!1),400===e.t0.response.status?te({isError:!0,msg:"Invalid inputs"}):te({isError:!0,msg:"Somthing went wrong!"});case 20:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(u.a,{children:Object(j.jsx)(w.a,{children:Object(j.jsxs)(k.a,{md:6,lg:4,className:" mx-auto bg-light p-4 my-4 shadow-sm",children:[Object(j.jsx)("h2",{className:" text-center h4 m-3 text-secondary",children:"Update Post"}),Object(j.jsxs)(N.a,{onSubmit:re,children:[Object(j.jsxs)(N.a.Group,{className:"mb-3",children:[Object(j.jsx)(N.a.Label,{children:"Post title"}),Object(j.jsx)(N.a.Control,{type:"text",value:h,name:"title",className:function(){if(H.touched)return H.isValid?"border border-success":"border border-danger"}(),onChange:function(e){var t=e.target.value;p(t);var a=Object(g.a)({},H);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Title is required."):t.length<3?(a.isValid=!1,a.msg="Title must be more than 2 characters."):t.length>255?(a.isValid=!1,a.msg="Title must be less than 255 characters."):(a.isValid=!0,a.msg=""),J(Object(g.a)({},a))}}),H.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:H.msg})]}),Object(j.jsxs)(N.a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[Object(j.jsx)(N.a.Label,{children:"Post body"}),Object(j.jsx)(N.a.Control,{as:"textarea",value:E,rows:3,name:"body",className:function(){if(Y.touched)return Y.isValid?"border border-success":"border border-danger"}(),onChange:function(e){var t=e.target.value;C(t);var a=Object(g.a)({},Y);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Body is required."):t.length<5?(a.isValid=!1,a.msg="Body must be more than 4 characters."):t.length>1e4?(a.isValid=!1,a.msg="Body must be less than 10000 characters."):(a.isValid=!0,a.msg=""),X(Object(g.a)({},a))}}),Y.msg&&Object(j.jsx)("small",{className:"text-danger p-1",children:Y.msg})]}),Object(j.jsxs)(N.a.Group,{controlId:"formFile",className:"mb-3",children:[Object(j.jsx)(N.a.Label,{children:"Post image"}),Object(j.jsx)("div",{className:"d-flex my-2 justify-content-center",children:Object(j.jsx)(k.a,{xs:6,md:4,children:P?Object(j.jsx)(Q.a,{src:URL.createObjectURL(P),thumbnail:!0}):Object(j.jsx)(Q.a,{src:"https://azstorageabdelrazek.blob.core.windows.net/postimgs/".concat(l),thumbnail:!0})})}),Object(j.jsx)(N.a.Control,{type:"file",name:"image",accept:"image/png, image/jpeg, image/jpg, image/JPG, image/svg, image/webp",onChange:function(e){return B(e.target.files[0])}})]}),Object(j.jsx)(S.a,{variant:"primary",type:"submit",className:"w-100",disabled:!H.isValid||!Y.isValid,children:F?"Loading ...":"Update Post"})]}),ee.isError&&Object(j.jsx)("div",{className:"alert alert-danger text-center my-2",children:ee.msg}),q&&Object(j.jsx)("div",{className:"alert alert-success text-center my-2",children:"Post Updated Successfully"})]})})})},Z=function(e){var t=Object(s.useContext)(o.a),a=t.user,r=t.dispatch,c=Object(d.h)().id,n=Object(s.useState)(null),b=Object(f.a)(n,2),m=b[0],h=b[1],p=Object(s.useState)({isError:!1,isSuccess:!1}),v=Object(f.a)(p,2),w=v[0],k=v[1];Object(s.useEffect)((function(){(function(){var e=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("/api/v1/posts/".concat(c));case 2:t=e.sent,h(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c]);var N=y.a.create();if(a){var V=function(){var e=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.post("/api/v1/users/refresh-token",{token:a.refreshToken});case 3:return t=e.sent,r({type:"LOGIN_SUCCESS",payload:Object(g.a)(Object(g.a)({},a),{},{accessToken:t.data.accessToken})}),e.abrupt("return",t.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),T=Object(_.a)(a.accessToken);N.interceptors.request.use(function(){var e=Object(x.a)(O.a.mark((function e(t){var a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Date,!(1e3*T.exp<a.getTime())){e.next=6;break}return e.next=4,V();case 4:s=e.sent,t.headers["auth-token"]=s.accessToken;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)}))}var P=function(){var e=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.delete("/api/v1/posts/".concat(t),{headers:{"auth-token":a.accessToken}});case 3:e.sent&&(k({isError:!1,isSuccess:!0}),setTimeout(window.location.replace("/app"),3e3)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),k({isError:!0,isSuccess:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return m?Object(j.jsxs)(u.a,{children:[w.isError&&Object(j.jsx)(L.a,{variant:"danger",onClose:function(){return k({isError:!1,isSuccess:!1})},className:"success-alert",dismissible:!0,children:Object(j.jsx)(L.a.Heading,{className:"f-1",children:"Somthing went wrong!"})}),w.isSuccess&&Object(j.jsx)(L.a,{variant:"success",onClose:function(){return k({isError:!1,isSuccess:!1})},className:"success-alert",dismissible:!0,children:Object(j.jsx)(L.a.Heading,{className:"f-1",children:"Post has been successfully deleted"})}),Object(j.jsxs)(E.a,{className:"my-4",children:[Object(j.jsx)("div",{style:{textAlign:"center"},children:Object(j.jsx)(E.a.Img,{className:"w-50 my-2",src:m.postImg?"https://azstorageabdelrazek.blob.core.windows.net/postimgs/".concat(m.postImg):I})}),Object(j.jsxs)(E.a.Body,{children:[Object(j.jsxs)("div",{className:"px-1 text-center",children:[Object(j.jsx)(E.a.Title,{children:m.title}),Object(j.jsx)(E.a.Text,{className:"first-letter",style:{lineHeight:2},children:m.body})]}),Object(j.jsxs)(C.a,{variant:"flush",children:[Object(j.jsx)(C.a.Item,{children:a&&a._id===m.createdBy._id?Object(j.jsx)(l.b,{className:"username-link",to:"/edit-profile",children:m.createdBy?m.createdBy.username:"user"}):Object(j.jsx)(l.b,{className:"username-link",to:{pathname:"/profile/".concat(m.createdBy._id),state:{username:m.createdBy.username}},children:m.createdBy?m.createdBy.username:"user"})}),Object(j.jsx)(C.a.Item,{children:new Date(m.createdAt).toDateString()}),a&&a._id===m.createdBy._id?Object(j.jsxs)(C.a.Item,{children:[Object(j.jsx)(l.b,{className:"btn btn-primary",to:{pathname:"/edit-post/".concat(m._id),state:{postTitle:m.title,postBody:m.body,postImg:m.postImg}},style:{marginRight:"5px"},children:"Edit Post"}),Object(j.jsx)(S.a,{variant:"danger",onClick:function(){return P(c)},children:"Delete Post"})]}):null]})]})]})]}):Object(j.jsx)("div",{className:"d-flex justify-content-center m-4",children:Object(j.jsx)(i.a,{animation:"border",role:"status"})})},$=r.a.lazy((function(){return a.e(3).then(a.bind(null,133))})),ee=function(){var e=Object(s.useContext)(o.a).user;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)(l.a,{basename:"/app",children:[Object(j.jsx)(K,{}),Object(j.jsxs)(d.d,{children:[Object(j.jsx)(d.b,{path:"/",exact:!0,component:z}),Object(j.jsx)(d.b,{path:"/about",component:h}),Object(j.jsx)(d.b,{path:"/login",component:V}),Object(j.jsx)(d.b,{path:"/register",component:B}),Object(j.jsx)(d.b,{path:"/profile/:id",component:P}),Object(j.jsx)(d.b,{path:"/posts/:id",component:Z}),e?Object(j.jsx)(d.b,{path:"/add-post",render:function(){return Object(j.jsx)(s.Suspense,{fallback:Object(j.jsx)(i.a,{animation:"border",role:"status"}),children:Object(j.jsx)($,{})})}}):Object(j.jsx)(d.a,{from:"/add-post",to:"/login"}),e&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(d.b,{path:"/edit-profile",component:U}),Object(j.jsx)(d.b,{path:"/edit-post/:id",component:X})]}),Object(j.jsx)(d.a,{from:"/home",to:"/"}),Object(j.jsx)(d.b,{component:H})]}),Object(j.jsx)(Y,{})]})})};n.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(o.b,{children:Object(j.jsx)(ee,{})})}),document.getElementById("root"))},15:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var s=a(6),r=a(1),c=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isFetching:!1,error:!0};case"LOGOUT":return{user:null,isFetching:!1,error:!1};default:return e}},n=a(0),i={user:JSON.parse(localStorage.getItem("user"))||null,isFetching:!1,error:!1},o=Object(r.createContext)(i),l=function(e){var t=e.children,a=Object(r.useReducer)(c,i),l=Object(s.a)(a,2),d=l[0],u=l[1];return Object(r.useEffect)((function(){localStorage.setItem("user",JSON.stringify(d.user))}),[d.user]),Object(n.jsx)(o.Provider,{value:{user:d.user,isFetching:d.isFetching,error:d.error,dispatch:u},children:t})}},88:function(e,t,a){}},[[119,1,2]]]);
//# sourceMappingURL=main.d56a91a8.chunk.js.map