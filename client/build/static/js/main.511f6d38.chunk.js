(this["webpackJsonphello-react"]=this["webpackJsonphello-react"]||[]).push([[0],{119:function(e,t,s){"use strict";s.r(t);var a=s(1),r=s.n(a),c=s(25),n=s.n(c),i=(s(88),s(2)),o=s(122),l=s(15),d=s(13),u=s(10),j=s(7),b=s.n(j),m=s(9),h=s(6),p=s(14),O=s.n(p),x=s(130),g=s(132),f=s(121),v=s.p+"static/media/defaultImg.11e9da86.jpg",y=s(0),w=function(e){var t=e.post,s=e.onShow,r=e.userProfile,c=e.onDelete,n=Object(a.useContext)(l.a).user;return Object(y.jsxs)(x.a,{className:"mb-4 mx-4 mx-lg-0",children:[Object(y.jsx)(d.b,{to:"/posts/".concat(t._id),children:Object(y.jsx)(x.a.Img,{variant:"top",src:t.postImg?"https://azstorageabdelrazek.blob.core.windows.net/postimgs/".concat(t.postImg):v})}),Object(y.jsxs)(x.a.Body,{children:[Object(y.jsxs)("div",{className:"px-1 text-center",children:[Object(y.jsx)(x.a.Title,{children:t.title}),Object(y.jsx)(x.a.Text,{children:function(){if(t.body.length<150)return t.body;var e=t.body.substr(0,150);return e=e.substr(0,Math.min(e.length,e.lastIndexOf(" "))),"".concat(e," . . .")}()})]}),Object(y.jsxs)(g.a,{variant:"flush",children:[Object(y.jsx)(g.a.Item,{children:n&&n._id===t.createdBy._id?Object(y.jsx)(d.b,{className:"username-link",to:"/edit-profile",children:t.createdBy?t.createdBy.username:"user"}):Object(y.jsx)(d.b,{className:"username-link",to:{pathname:"/profile/".concat(t.createdBy._id),state:{username:t.createdBy.username}},children:t.createdBy?t.createdBy.username:"user"})}),Object(y.jsx)(g.a.Item,{children:new Date(t.createdAt).toDateString()}),Object(y.jsxs)(g.a.Item,{children:[Object(y.jsx)(d.b,{className:"btn btn-primary",style:{marginRight:"5px"},to:"/posts/".concat(t._id),children:"Open Post"}),!r&&Object(y.jsx)(f.a,{variant:"primary",onClick:function(){return s(t)},children:"Open Modal"}),r&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(d.b,{className:"btn btn-primary",to:{pathname:"/edit-post/".concat(t._id),state:{postTitle:t.title,postBody:t.body,postImg:t.postImg}},style:{marginRight:"5px"},children:"Edit Post"}),Object(y.jsx)(f.a,{variant:"danger",onClick:function(){return c(t)},children:"Delete Post"})]})]})]})]})]})},k=s(127),N=function(e){var t=e.showModal,s=e.hideModal,a=e.modalData;return Object(y.jsxs)(k.a,{show:t,size:"lg",centered:!0,onHide:s,children:[Object(y.jsx)(k.a.Header,{closeButton:!0,children:Object(y.jsx)(k.a.Title,{id:"contained-modal-title-vcenter",children:a.title})}),Object(y.jsx)(k.a.Body,{children:Object(y.jsx)("p",{children:a.body})}),Object(y.jsx)(k.a.Footer,{children:Object(y.jsx)(f.a,{onClick:s,children:"Close"})})]})},S=s(81),V=s(123),E=s(124),C=function(e){var t=e.posts,s=Object(a.useState)(!1),r=Object(h.a)(s,2),c=r[0],n=r[1],i=Object(a.useState)({}),l=Object(h.a)(i,2),d=l[0],u=l[1];return Object(y.jsxs)(V.a,{children:[Object(y.jsx)("h2",{id:"posts",className:"h3 border-bottom mb-4 pb-4 text-primary",children:"Posts"}),Object(y.jsx)(N,{showModal:c,hideModal:function(){n(!1)},modalData:d}),Object(y.jsx)(E.a,{className:"justify-content-center g-4",children:t&&t.length>0?t.map((function(e){return Object(y.jsx)(S.a,{md:6,lg:4,children:Object(y.jsx)(w,{post:e,onShow:function(){return function(e){n(!0),u(e)}(e)}})},e._id)})):Object(y.jsx)(o.a,{animation:"border",role:"status"})})]})},I=function(){var e=Object(a.useState)([]),t=Object(h.a)(e,2),s=t[0],r=t[1];return Object(a.useEffect)((function(){(function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("/posts");case 3:t=e.sent,r(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(y.jsx)("div",{children:Object(y.jsx)(C,{posts:s})})},T=function(e){var t=e.title;return Object(y.jsx)("div",{className:"head d-flex justify-content-center align-items-center",children:Object(y.jsx)(V.a,{className:"d-flex justify-content-center",children:Object(y.jsx)("h1",{className:"text-white display-2 mx-3",children:t||"Welcome to Our Blog"})})})},P=function(){var e=Object(a.useContext)(l.a).user;return Object(y.jsxs)("div",{children:[Object(y.jsx)(T,{title:e&&"Welcome ".concat(e.username,", to our blog")}),Object(y.jsx)(I,{})]})},B=s(45),_=function(){return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(T,{title:"Contact Me"}),Object(y.jsx)("div",{class:"features text-center",children:Object(y.jsx)("div",{class:"container",children:Object(y.jsxs)("div",{class:"row",children:[Object(y.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#2867B2"},class:"col hover-opacity",href:"https://www.linkedin.com/in/abdelrazek-ali/",children:[Object(y.jsx)(B.c,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(y.jsx)("h4",{className:"mb-5",children:"LinkedIn"})]}),Object(y.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#161b22"},class:"col hover-opacity",href:"https://github.com/abdelrazekAli",children:[Object(y.jsx)(B.b,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(y.jsx)("h4",{children:"Github"})]}),Object(y.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#ec4636"},class:"col hover-opacity",href:"mailto:dev.abdelrazek@gmail.com?subject=contact",children:[Object(y.jsx)(B.d,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(y.jsx)("h4",{children:"Gmail"})]}),Object(y.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#4267B2"},class:"col hover-opacity",href:"https://www.facebook.com/dev.abdelrazek/",children:[Object(y.jsx)(B.a,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(y.jsx)("h4",{children:"Facebook"})]}),Object(y.jsxs)("a",{target:"_blank",rel:"noreferrer",style:{color:"#25D366"},class:"col hover-opacity",href:"https://api.whatsapp.com/send?phone=+201155596710",children:[Object(y.jsx)(B.e,{style:{fontSize:"3rem",cursor:"pointer"},className:"my-2"}),Object(y.jsx)("h4",{children:"Whatsapp"})]})]})})})]})},L=s(128),U=function(){var e=Object(a.useState)({touched:!1,isValid:!1,msg:""}),t=Object(h.a)(e,2),s=t[0],r=t[1],c=Object(a.useState)({touched:!1,isValid:!1,msg:""}),n=Object(h.a)(c,2),o=n[0],d=n[1],u=Object(a.useContext)(l.a),j=u.dispatch,p=u.isFetching,x=u.error,g=function(){var e=Object(m.a)(b.a.mark((function e(t){var a,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),j({type:"LOGIN_START"}),a=t.target.email.value,r=t.target.password.value,e.prev=3,!s.isValid||!o.isValid){e.next=10;break}return e.next=7,O.a.post("/users/login",{email:a,password:r});case 7:c=e.sent,j({type:"LOGIN_SUCCESS",payload:c.data}),window.location.replace("/app");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),j({type:"LOGIN_FAILURE"}),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsx)(V.a,{children:Object(y.jsx)(E.a,{children:Object(y.jsxs)(S.a,{md:6,lg:4,className:" mx-auto bg-light p-4 my-4 shadow-sm",children:[Object(y.jsx)("h2",{className:" text-center h4 m-3 text-secondary",children:"Login"}),Object(y.jsxs)(L.a,{onSubmit:g,children:[Object(y.jsxs)(L.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(y.jsx)(L.a.Label,{children:"Email address"}),Object(y.jsx)(L.a.Control,{type:"email",placeholder:"Enter email",name:"email",onBlur:function(e){var t=e.target.value.trim(),a=Object(i.a)({},s);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Email is required."):/\S+@\S+\.\S+/.test(t)?t.length>100?(a.isValid=!1,a.msg="Email must be less than 100 characters."):(a.isValid=!0,a.msg=""):(a.isValid=!1,a.msg="Email is not valid"),r(Object(i.a)({},a))},className:function(){if(s.touched)return s.isValid?"border border-success":"border border-danger"}()}),s.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:s.msg})]}),Object(y.jsxs)(L.a.Group,{className:"mb-3",controlId:"formPlaintextPassword",children:[Object(y.jsx)(L.a.Label,{children:"Password"}),Object(y.jsx)(L.a.Control,{type:"password",placeholder:"Enter password",name:"password",onKeyUp:function(e){var t=e.target.value.trim(),s=Object(i.a)({},o);s.touched=!0,t.length<=0?(s.isValid=!1,s.msg="Password is required."):t.length<4?(s.isValid=!1,s.msg="Password must be more than 3 characters."):t.length>255?(s.isValid=!1,s.msg="Password must be less than 255 characters."):(s.isValid=!0,s.msg=""),d(Object(i.a)({},s))},className:function(){if(o.touched)return o.isValid?"border border-success":"border border-danger"}()}),o.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:o.msg})]}),Object(y.jsx)(f.a,{variant:"primary",type:"submit",className:"w-100",disabled:!s.isValid||!o.isValid,children:p?"Loading ...":"Login"}),x&&Object(y.jsx)("div",{className:"alert alert-danger text-center my-2",children:"Invalid email or password"})]})]})})})},G=function(){var e=Object(a.useState)([]),t=Object(h.a)(e,2),s=t[0],r=t[1],c=Object(u.g)(),n=Object(u.h)().id,i=c.state.username;Object(a.useEffect)((function(){(function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("/posts?userId=".concat(n));case 3:t=e.sent,r(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[n]);return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(T,{title:"".concat(i)}),Object(y.jsxs)(V.a,{children:[Object(y.jsxs)("h2",{id:"posts",className:"h3 border-bottom mb-4 pb-4 text-primary",children:[i," posts"]}),Object(y.jsx)(E.a,{className:"justify-content-center g-4",children:s.length>0?s.map((function(e){return Object(y.jsx)(S.a,{md:6,lg:4,children:Object(y.jsx)(w,{post:e})},e._id)})):Object(y.jsx)(o.a,{animation:"border",role:"status"})})]})]})},F=function(){var e=Object(a.useState)({touched:!1,isValid:!1,msg:""}),t=Object(h.a)(e,2),s=t[0],r=t[1],c=Object(a.useState)({touched:!1,isValid:!1,msg:""}),n=Object(h.a)(c,2),o=n[0],l=n[1],d=Object(a.useState)({touched:!1,isValid:!1,msg:""}),u=Object(h.a)(d,2),j=u[0],p=u[1],x=Object(a.useState)({isError:!1,msg:""}),g=Object(h.a)(x,2),v=g[0],w=g[1],k=Object(a.useState)(!1),N=Object(h.a)(k,2),C=N[0],I=N[1],T=function(){var e=Object(m.a)(b.a.mark((function e(t){var a,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),I(!0),w({isError:!1,msg:""}),a=t.target.username.value,r=t.target.email.value,c=t.target.password.value,e.prev=4,!(s.isValid&&o.isValid&&j.isValid)){e.next=10;break}return e.next=8,O.a.post("/users",{username:a,email:r,password:c});case 8:e.sent.data&&(window.location.replace("/app/login"),I(!1));case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),I(!1),409===e.t0.response.status?w({isError:!0,msg:"Email is already used"}):w({isError:!0,msg:"Somthing went wrong!"});case 16:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsx)(V.a,{children:Object(y.jsx)(E.a,{children:Object(y.jsxs)(S.a,{md:6,lg:4,className:" mx-auto bg-light p-4 my-4 shadow-sm",children:[Object(y.jsx)("h2",{className:" text-center h4 m-3 text-secondary",children:"Register"}),Object(y.jsxs)(L.a,{onSubmit:T,children:[Object(y.jsxs)(L.a.Group,{className:"mb-3",children:[Object(y.jsx)(L.a.Label,{children:"Username"}),Object(y.jsx)(L.a.Control,{type:"text",placeholder:"Enter username",name:"username",onBlur:function(e){var t=e.target.value.trim(),a=Object(i.a)({},s);a.touched=!0,t.length<=0?(a.isValid=!1,a.msg="Username is required."):t.length<4?(a.isValid=!1,a.msg="Username must be more than 3 characters."):t.length>100?(a.isValid=!1,a.msg="Username must be less than 100 characters."):(a.isValid=!0,a.msg=""),r(Object(i.a)({},a))},className:function(){if(s.touched)return s.isValid?"border border-success":"border border-danger"}()}),s.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:s.msg})]}),Object(y.jsxs)(L.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(y.jsx)(L.a.Label,{children:"Email address"}),Object(y.jsx)(L.a.Control,{type:"email",placeholder:"Enter email",name:"email",onBlur:function(e){var t=e.target.value.trim(),s=Object(i.a)({},o);s.touched=!0,t.length<=0?(s.isValid=!1,s.msg="Email is required."):/\S+@\S+\.\S+/.test(t)?t.length>100?(s.isValid=!1,s.msg="Email must be less than 100 characters."):(s.isValid=!0,s.msg=""):(s.isValid=!1,s.msg="Email is not valid"),l(Object(i.a)({},s))},className:function(){if(o.touched)return o.isValid?"border border-success":"border border-danger"}()}),o.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:o.msg})]}),Object(y.jsxs)(L.a.Group,{className:"mb-3",controlId:"formPlaintextPassword1",children:[Object(y.jsx)(L.a.Label,{children:"Password"}),Object(y.jsx)(L.a.Control,{type:"password",placeholder:"Enter password",name:"password",onKeyUp:function(e){var t=e.target.value.trim(),s=Object(i.a)({},j);s.touched=!0,t.length<=0?(s.isValid=!1,s.msg="Password is required."):t.length<4?(s.isValid=!1,s.msg="Password must be more than 3 characters."):t.length>255?(s.isValid=!1,s.msg="Password must be less than 255 characters."):(s.isValid=!0,s.msg=""),p(Object(i.a)({},s))},className:function(){if(j.touched)return j.isValid?"border border-success":"border border-danger"}()}),j.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:j.msg})]}),Object(y.jsx)(f.a,{variant:"primary",type:"submit",className:"w-100",disabled:!s.isValid||!o.isValid||!j.isValid,children:C?"Loading ...":"Register"}),v.isError&&Object(y.jsx)("div",{className:"alert alert-danger text-center my-2",children:v.msg})]})]})})})},D=s(38),z=s(125),q=function(e){var t=Object(a.useContext)(l.a),s=t.user,r=t.dispatch,c=Object(u.h)().id,n=Object(a.useState)(null),j=Object(h.a)(n,2),p=j[0],w=j[1],k=Object(a.useState)({isError:!1,isSuccess:!1}),N=Object(h.a)(k,2),S=N[0],E=N[1];Object(a.useEffect)((function(){(function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("/posts/".concat(c));case 2:t=e.sent,w(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c]);var C=O.a.create();if(s){var I=function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post("/users/refresh-token",{token:s.refreshToken});case 3:return t=e.sent,r({type:"LOGIN_SUCCESS",payload:Object(i.a)(Object(i.a)({},s),{},{accessToken:t.data.accessToken})}),e.abrupt("return",t.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),T=Object(D.a)(s.accessToken);C.interceptors.request.use(function(){var e=Object(m.a)(b.a.mark((function e(t){var s,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=new Date,!(1e3*T.exp<s.getTime())){e.next=6;break}return e.next=4,I();case 4:a=e.sent,t.headers["auth-token"]=a.accessToken;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)}))}var P=function(){var e=Object(m.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.delete("/posts/".concat(t),{headers:{"auth-token":s.accessToken}});case 3:e.sent&&(E({isError:!1,isSuccess:!0}),setTimeout(window.location.replace("/app"),3e3)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),E({isError:!0,isSuccess:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return p?Object(y.jsxs)(V.a,{children:[S.isError&&Object(y.jsx)(z.a,{variant:"danger",onClose:function(){return E({isError:!1,isSuccess:!1})},className:"success-alert",dismissible:!0,children:Object(y.jsx)(z.a.Heading,{className:"f-1",children:"Somthing went wrong!"})}),S.isSuccess&&Object(y.jsx)(z.a,{variant:"success",onClose:function(){return E({isError:!1,isSuccess:!1})},className:"success-alert",dismissible:!0,children:Object(y.jsx)(z.a.Heading,{className:"f-1",children:"Post has been successfully deleted"})}),Object(y.jsxs)(x.a,{className:"my-4",children:[Object(y.jsx)("div",{style:{textAlign:"center"},children:Object(y.jsx)(x.a.Img,{className:"w-50 my-2",src:p.postImg?"https://azstorageabdelrazek.blob.core.windows.net/postimgs/".concat(p.postImg):v})}),Object(y.jsxs)(x.a.Body,{children:[Object(y.jsxs)("div",{className:"px-1 text-center",children:[Object(y.jsx)(x.a.Title,{children:p.title}),Object(y.jsx)(x.a.Text,{className:"first-letter",style:{lineHeight:2},children:p.body})]}),Object(y.jsxs)(g.a,{variant:"flush",children:[Object(y.jsx)(g.a.Item,{children:s&&s._id===p.createdBy._id?Object(y.jsx)(d.b,{className:"username-link",to:"/edit-profile",children:p.createdBy?p.createdBy.username:"user"}):Object(y.jsx)(d.b,{className:"username-link",to:{pathname:"/profile/".concat(p.createdBy._id),state:{username:p.createdBy.username}},children:p.createdBy?p.createdBy.username:"user"})}),Object(y.jsx)(g.a.Item,{children:new Date(p.createdAt).toDateString()}),s&&s._id===p.createdBy._id?Object(y.jsxs)(g.a.Item,{children:[Object(y.jsx)(d.b,{className:"btn btn-primary",to:{pathname:"/edit-post/".concat(p._id),state:{postTitle:p.title,postBody:p.body,postImg:p.postImg}},style:{marginRight:"5px"},children:"Edit Post"}),Object(y.jsx)(f.a,{variant:"danger",onClick:function(){return P(c)},children:"Delete Post"})]}):null]})]})]})]}):Object(y.jsx)("div",{className:"d-flex justify-content-center m-4",children:Object(y.jsx)(o.a,{animation:"border",role:"status"})})},R=function(e){return Object(y.jsx)("div",{children:Object(y.jsx)(q,Object(i.a)({},e))})},A=function(){var e=Object(a.useContext)(l.a),t=e.user,s=e.dispatch,r=Object(a.useState)(t.username),c=Object(h.a)(r,2),n=c[0],o=c[1],u=Object(a.useState)(t.email),j=Object(h.a)(u,2),p=j[0],x=j[1],g=Object(a.useState)({touched:!1,isValid:!0,msg:""}),v=Object(h.a)(g,2),k=v[0],N=v[1],C=Object(a.useState)({touched:!1,isValid:!0,msg:""}),I=Object(h.a)(C,2),T=I[0],P=I[1],B=Object(a.useState)([]),_=Object(h.a)(B,2),U=_[0],G=_[1],F=Object(a.useState)(!1),q=Object(h.a)(F,2),R=q[0],A=q[1],M=Object(a.useState)({isError:!1,isSuccess:!1}),H=Object(h.a)(M,2),J=H[0],W=H[1],K=Object(a.useState)(!1),Y=Object(h.a)(K,2),Q=Y[0],X=Y[1],Z=Object(a.useState)(!1),$=Object(h.a)(Z,2),ee=$[0],te=$[1],se=Object(a.useState)({isError:!1,msg:""}),ae=Object(h.a)(se,2),re=ae[0],ce=ae[1],ne=Object(a.useState)(!1),ie=Object(h.a)(ne,2),oe=ie[0],le=ie[1];Object(a.useEffect)((function(){(function(){var e=Object(m.a)(b.a.mark((function e(){var s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("/posts?userId=".concat(t._id));case 3:s=e.sent,G(s.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[R,t._id]);var de=function(){var e=Object(m.a)(b.a.mark((function e(){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post("/users/refresh-token",{token:t.refreshToken});case 3:return a=e.sent,s({type:"LOGIN_SUCCESS",payload:Object(i.a)(Object(i.a)({},t),{},{accessToken:a.data.accessToken})}),e.abrupt("return",a.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),ue=O.a.create(),je=Object(D.a)(t.accessToken);ue.interceptors.request.use(function(){var e=Object(m.a)(b.a.mark((function e(t){var s,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=new Date,!(1e3*je.exp<s.getTime())){e.next=6;break}return e.next=4,de();case 4:a=e.sent,t.headers["auth-token"]=a.accessToken;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)}));var be=function(){var e=Object(m.a)(b.a.mark((function e(s){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ue.delete("/posts/".concat(s._id),{headers:{"auth-token":t.accessToken}});case 3:e.sent&&(A(!R),W({isError:!1,isSuccess:!0})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),W({isError:!0,isSuccess:!1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(m.a)(b.a.mark((function e(a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),e.prev=1,le(!0),ce({isError:!1,msg:""}),!k.isValid||!T.isValid){e.next=9;break}return e.next=7,ue.put("/users/".concat(t._id),{username:n,email:p},{headers:{"auth-token":t.accessToken}});case 7:(r=e.sent)&&(s({type:"LOGIN_SUCCESS",payload:Object(i.a)(Object(i.a)({},t),{},{username:r.data.username,email:r.data.email})}),le(!1),te(!0));case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),te(!1),le(!1),409===e.t0.response.status?ce({isError:!0,msg:"Email is already used"}):ce({isError:!0,msg:"Somthing went wrong!"});case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsxs)(V.a,{children:[J.isError&&Object(y.jsx)(z.a,{variant:"danger",onClose:function(){return W({isError:!1,isSuccess:!1})},className:"success-alert",dismissible:!0,children:Object(y.jsx)(z.a.Heading,{className:"f-1",children:"Somthing went wrong!"})}),J.isSuccess&&Object(y.jsx)(z.a,{variant:"success",onClose:function(){return W({isError:!1,isSuccess:!1})},className:"success-alert",dismissible:!0,children:Object(y.jsx)(z.a.Heading,{className:"f-1",children:"Post has been successfully deleted"})}),Object(y.jsx)(E.a,{children:Object(y.jsxs)(S.a,{md:6,lg:4,className:" mx-auto bg-light p-4 my-4 shadow-sm",children:[!Q&&Object(y.jsx)("div",{style:{textAlign:"center"},children:Object(y.jsx)(f.a,{variant:"primary",className:"w-50",onClick:function(){return X(!0)},children:"Update Profile"})}),Q&&Object(y.jsxs)(L.a,{onSubmit:me,children:[Object(y.jsxs)(L.a.Group,{className:"mb-3",children:[Object(y.jsx)(L.a.Label,{children:"Username"}),Object(y.jsx)(L.a.Control,{type:"text",placeholder:"Enter username",name:"username",value:n,onChange:function(e){var t=e.target.value;o(t);var s=Object(i.a)({},k);s.touched=!0,t.length<=0?(s.isValid=!1,s.msg="Username is required."):t.length<4?(s.isValid=!1,s.msg="Username must be more than 3 characters."):t.length>100?(s.isValid=!1,s.msg="Username must be less than 100 characters."):(s.isValid=!0,s.msg=""),N(Object(i.a)({},s))},className:function(){if(k.touched)return k.isValid?"border border-success":"border border-danger"}()}),k.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:k.msg})]}),Object(y.jsxs)(L.a.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:[Object(y.jsx)(L.a.Label,{children:"Email address"}),Object(y.jsx)(L.a.Control,{type:"email",placeholder:"Enter email",name:"email",value:p,onChange:function(e){var t=e.target.value;x(t);var s=Object(i.a)({},T);s.touched=!0,t.length<=0?(s.isValid=!1,s.msg="Email is required."):!function(e){return/\S+@\S+\.\S+/.test(e)}(t)?(s.isValid=!1,s.msg="Email is not valid"):t.length>100?(s.isValid=!1,s.msg="Email must be less than 100 characters."):(s.isValid=!0,s.msg=""),P(Object(i.a)({},s))},className:function(){if(T.touched)return T.isValid?"border border-success":"border border-danger"}()}),T.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:T.msg})]}),Object(y.jsx)(f.a,{variant:"primary",type:"submit",className:"w-100",disabled:!k.isValid||!T.isValid,children:oe?"Loading ...":"Update"}),ee&&Object(y.jsx)("div",{className:"alert alert-success text-center my-2",children:"Update Successfully"}),re.isError&&Object(y.jsx)("div",{className:"alert alert-danger text-center my-2",children:re.msg})]})]})}),Object(y.jsx)("h2",{id:"posts",className:"h3 border-bottom mb-4 pb-4 text-primary",children:"Your Posts"}),Object(y.jsx)(E.a,{className:"justify-content-center g-4",children:U.length>0?U.map((function(e){return Object(y.jsx)(S.a,{md:6,lg:4,children:Object(y.jsx)(w,{post:e,userProfile:!0,onDelete:be})},e._id)})):Object(y.jsxs)("h5",{className:"my-4",children:["You do not have any posts, ",Object(y.jsx)(d.b,{to:"/posts/add-post",children:"Write now"})]})})]})},M=s(126),H=function(){var e=Object(a.useContext)(l.a),t=e.user,s=e.dispatch,r=Object(u.h)().id,c=Object(u.g)().state,n=c.postTitle,o=c.postBody,d=c.postImg,j=Object(a.useState)({touched:!1,isValid:!0,msg:""}),p=Object(h.a)(j,2),x=p[0],g=p[1],v=Object(a.useState)({touched:!1,isValid:!0,msg:""}),w=Object(h.a)(v,2),k=w[0],N=w[1],C=Object(a.useState)(n),I=Object(h.a)(C,2),T=I[0],P=I[1],B=Object(a.useState)(o),_=Object(h.a)(B,2),U=_[0],G=_[1],F=Object(a.useState)(null),z=Object(h.a)(F,2),q=z[0],R=z[1],A=Object(a.useState)(!1),H=Object(h.a)(A,2),J=H[0],W=H[1],K=Object(a.useState)(!1),Y=Object(h.a)(K,2),Q=Y[0],X=Y[1],Z=Object(a.useState)({isError:!1,msg:""}),$=Object(h.a)(Z,2),ee=$[0],te=$[1],se=function(){var e=Object(m.a)(b.a.mark((function e(){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post("/users/refresh-token",{token:t.refreshToken});case 3:return a=e.sent,s({type:"LOGIN_SUCCESS",payload:Object(i.a)(Object(i.a)({},t),{},{accessToken:a.data.accessToken})}),e.abrupt("return",a.data);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),ae=O.a.create();ae.interceptors.request.use(function(){var e=Object(m.a)(b.a.mark((function e(s){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Date,!(1e3*Object(D.a)(t.accessToken).exp<a.getTime())){e.next=7;break}return e.next=5,se();case 5:r=e.sent,s.headers["auth-token"]=r.accessToken;case 7:return e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)}));var re=function(){var e=Object(m.a)(b.a.mark((function e(s){var a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),e.prev=1,!x.isValid||!k.isValid){e.next=14;break}return(a=new FormData).append("title",T),a.append("body",U),q&&a.append("image",q),console.log(T,U,q),W(!0),e.next=11,ae({method:"put",url:"/posts/".concat(r),data:a,headers:{"auth-token":t.accessToken,"Content-Type":"multipart/form-data"}});case 11:c=e.sent,console.log(c),c.data&&(W(!1),X(!0));case 14:e.next=22;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0),W(!1),X(!1),400===e.t0.response.status?te({isError:!0,msg:"Invalid inputs"}):te({isError:!0,msg:"Somthing went wrong!"});case 22:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsx)(V.a,{children:Object(y.jsx)(E.a,{children:Object(y.jsxs)(S.a,{md:6,lg:4,className:" mx-auto bg-light p-4 my-4 shadow-sm",children:[Object(y.jsx)("h2",{className:" text-center h4 m-3 text-secondary",children:"Update Post"}),Object(y.jsxs)(L.a,{onSubmit:re,children:[Object(y.jsxs)(L.a.Group,{className:"mb-3",children:[Object(y.jsx)(L.a.Label,{children:"Post title"}),Object(y.jsx)(L.a.Control,{type:"text",value:T,name:"title",className:function(){if(x.touched)return x.isValid?"border border-success":"border border-danger"}(),onChange:function(e){var t=e.target.value;P(t);var s=Object(i.a)({},x);s.touched=!0,t.length<=0?(s.isValid=!1,s.msg="Title is required."):t.length<3?(s.isValid=!1,s.msg="Title must be more than 2 characters."):t.length>255?(s.isValid=!1,s.msg="Title must be less than 255 characters."):(s.isValid=!0,s.msg=""),g(Object(i.a)({},s))}}),x.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:x.msg})]}),Object(y.jsxs)(L.a.Group,{className:"mb-3",controlId:"exampleForm.ControlTextarea1",children:[Object(y.jsx)(L.a.Label,{children:"Post body"}),Object(y.jsx)(L.a.Control,{as:"textarea",value:U,rows:3,name:"body",className:function(){if(k.touched)return k.isValid?"border border-success":"border border-danger"}(),onChange:function(e){var t=e.target.value;G(t);var s=Object(i.a)({},k);s.touched=!0,t.length<=0?(s.isValid=!1,s.msg="Body is required."):t.length<5?(s.isValid=!1,s.msg="Body must be more than 4 characters."):t.length>1e4?(s.isValid=!1,s.msg="Body must be less than 10000 characters."):(s.isValid=!0,s.msg=""),N(Object(i.a)({},s))}}),k.msg&&Object(y.jsx)("small",{className:"text-danger p-1",children:k.msg})]}),Object(y.jsxs)(L.a.Group,{controlId:"formFile",className:"mb-3",children:[Object(y.jsx)(L.a.Label,{children:"Post image"}),Object(y.jsx)("div",{className:"d-flex my-2 justify-content-center",children:Object(y.jsx)(S.a,{xs:6,md:4,children:q?Object(y.jsx)(M.a,{src:URL.createObjectURL(q),thumbnail:!0}):Object(y.jsx)(M.a,{src:"https://azstorageabdelrazek.blob.core.windows.net/postimgs/".concat(d),thumbnail:!0})})}),Object(y.jsx)(L.a.Control,{type:"file",name:"image",accept:"image/png, image/jpeg, image/jpg, image/JPG, image/svg, image/webp",onChange:function(e){return R(e.target.files[0])}})]}),Object(y.jsx)(f.a,{variant:"primary",type:"submit",className:"w-100",disabled:!x.isValid||!k.isValid,children:J?"Loading ...":"Update Post"})]}),ee.isError&&Object(y.jsx)("div",{className:"alert alert-danger text-center my-2",children:ee.msg}),Q&&Object(y.jsx)("div",{className:"alert alert-success text-center my-2",children:"Post Updated Successfully"})]})})})},J=s(129),W=s(131),K=function(){var e=Object(a.useContext)(l.a),t=e.user,s=e.dispatch,r=function(){var e=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post("/users/logout",{token:t.refreshToken});case 3:e.sent&&(s({type:"LOGOUT"}),window.location.replace("/app")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),window.location.replace("/app"),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(y.jsx)(J.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",sticky:"top",children:Object(y.jsxs)(V.a,{children:[Object(y.jsx)(J.a.Brand,{children:Object(y.jsx)(d.b,{className:"white-link",to:"/",children:"Mern Blog"})}),Object(y.jsx)(J.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(y.jsx)(J.a.Collapse,{id:"responsive-navbar-nav",className:"justify-content-end",children:Object(y.jsxs)(W.a,{className:"",children:[Object(y.jsx)(d.c,{className:"nav-link",exact:!0,to:"/",children:"home"}),t?null:Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(d.c,{className:"nav-link",to:"/login",children:"login"}),Object(y.jsx)(d.c,{className:"nav-link",to:"/register",children:"register"})]}),t?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(d.c,{className:"nav-link",to:"/posts/add-post",children:"write"}),Object(y.jsx)(d.c,{className:"nav-link",to:"/edit-profile",children:"profile"}),Object(y.jsx)("span",{className:"nav-link",style:{cursor:"pointer"},onClick:r,children:"logout"})]}):null,Object(y.jsx)(d.c,{className:"nav-link",to:"/about",children:"contact"})]})})]})})},Y=function(){return Object(y.jsx)("footer",{className:"d-flex justify-content-center p-4 bg-light",children:Object(y.jsx)("h4",{className:"lead text-secondary",children:" \xa9 2021 Abdelrazek"})})},Q=s(41),X=s(42),Z=s(61),$=s(59),ee=function(e){Object(Z.a)(s,e);var t=Object($.a)(s);function s(){return Object(Q.a)(this,s),t.apply(this,arguments)}return Object(X.a)(s,[{key:"componentDidMount",value:function(){this.props.history.replace("/not-found")}},{key:"render",value:function(){return Object(y.jsx)("div",{children:Object(y.jsx)(T,{title:"404 not found"})})}}]),s}(r.a.Component),te=r.a.lazy((function(){return s.e(3).then(s.bind(null,133))})),se=function(){var e=Object(a.useContext)(l.a).user;return Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(d.a,{basename:"/app",children:[Object(y.jsx)(K,{}),Object(y.jsxs)(u.d,{children:[Object(y.jsx)(u.b,{path:"/",exact:!0,component:P}),Object(y.jsx)(u.b,{path:"/about",component:_}),Object(y.jsx)(u.b,{path:"/edit-post/:id",component:H}),Object(y.jsx)(u.b,{path:"/edit-profile",component:A}),Object(y.jsx)(u.b,{path:"/profile/:id",component:G}),Object(y.jsx)(u.b,{path:"/login",component:U}),Object(y.jsx)(u.b,{path:"/register",component:F}),e?Object(y.jsx)(u.b,{path:"/posts/add-post",render:function(e){return Object(y.jsx)(a.Suspense,{fallback:Object(y.jsx)(o.a,{animation:"border",role:"status"}),children:Object(y.jsx)(te,Object(i.a)({},e))})}}):Object(y.jsx)(u.a,{from:"/posts/add-post",to:"/login"}),Object(y.jsx)(u.b,{path:"/posts/:id",component:R}),Object(y.jsx)(u.a,{from:"/home",to:"/"}),Object(y.jsx)(u.b,{component:ee})]}),Object(y.jsx)(Y,{})]})})};n.a.render(Object(y.jsx)(r.a.StrictMode,{children:Object(y.jsx)(l.b,{children:Object(y.jsx)(se,{})})}),document.getElementById("root"))},15:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return l}));var a=s(6),r=s(1),c=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isFetching:!1,error:!0};case"LOGOUT":return{user:null,isFetching:!1,error:!1};default:return e}},n=s(0),i={user:JSON.parse(localStorage.getItem("user"))||null,isFetching:!1,error:!1},o=Object(r.createContext)(i),l=function(e){var t=e.children,s=Object(r.useReducer)(c,i),l=Object(a.a)(s,2),d=l[0],u=l[1];return Object(r.useEffect)((function(){localStorage.setItem("user",JSON.stringify(d.user))}),[d.user]),Object(n.jsx)(o.Provider,{value:{user:d.user,isFetching:d.isFetching,error:d.error,dispatch:u},children:t})}},88:function(e,t,s){}},[[119,1,2]]]);
//# sourceMappingURL=main.511f6d38.chunk.js.map